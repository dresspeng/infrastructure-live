// For format details, see https://aka.ms/devcontainer.json. For config options, see the README at:
// https://github.com/microsoft/vscode-dev-containers/tree/v0.245.2/containers/ubuntu
{
	"name": "Alpine",
	"image": "401582117818.dkr.ecr.us-west-1.amazonaws.com/kookas-infrastructure-modules-master-devcontainer:latest",
	"runArgs": [
		"--env-file",
		".devcontainer/devcontainer.env"
	],
	"mounts": [		"source=/var/run/docker.sock,target=/var/run/docker.sock,type=bind"	],
	"initializeCommand": "export $(grep -v '^#' .devcontainer/devcontainer.env | xargs)  && aws --version && aws configure set aws_access_key_id $AWS_ACCESS_KEY && aws configure set aws_secret_access_key $AWS_SECRET_KEY && aws configure set region $AWS_REGION && aws configure list && aws ecr get-login-password --region $AWS_REGION | docker login --username AWS --password-stdin 401582117818.dkr.ecr.us-west-1.amazonaws.com",
	"postStartCommand": "make aws-auth && tflint --init",
	"features": {},
	"customizations": {
		"vscode": {
			"extensions": [
				"yzhang.markdown-all-in-one",
				"shakram02.bash-beautify",
				"hashicorp.terraform",
				"bierner.markdown-emoji",
				"ms-vscode.makefile-tools",
				"github.vscode-github-actions"
			]
		}
	}
}